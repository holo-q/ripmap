
[45m[1m RIPMAP L2 OUTER LOOP OPTIMIZER [0m[49m

ğŸ“„ Using default inner promptgram
Configuration:
  Run name:       l2_diagnostic_run
  Outer steps:    5
  Inner episodes: 5
  Inner agent:    claude
  Outer agent:    gemini
  Corpus:         curated
  L2 reasoning:   enabled
  Output dir:     "training-outer/runs/l2_diagnostic_run"

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Starting outer loop (5 steps)...

[46m[1m OUTER STEP 1/5 [0m[49m
  ğŸ“‹ Selected promptgram: inner_v001 (mode: best)
     [2KE 1/5 NDCG[â–                   ]0.824 Fail[â–                   ]6
     [2KE 2/5 NDCG[â–â–ˆ                  ]0.826 Fail[â–â–ˆ                  ]10
     [2KE 3/5 NDCG[â–â–†â–ˆ                 ]0.828 Fail[â–â–ˆâ–†                 ]9 âš¡CONVERGED
     [2KE 4/5 NDCG[â–â–„â–…â–ˆ                ]0.831 Fail[â–â–ˆâ–†â–                ]6 âš¡CONVERGED
     [2KE 5/5 NDCG[â–â–„â–…â–ˆâ–„               ]0.827 Fail[â–â–ˆâ–†â–â–…               ]8 âš¡CONVERGED
     [42m[1m TRAINING COMPLETE [0m[49m
     [1mNDCG@10[0m: 0.8236 â†‘ 0.8268  ([32m+0.0032[39m)
     Final NDCG@10: 0.8304
     Episodes: 5
  ğŸ† New best! NDCG=0.8268 - params saved for warm start
  ğŸ§  Invoking L2 reasoning (gemini)...
  ğŸ“ L2 proposal: mode=explore, confidence=0.90
     2 edits proposed
       â€¢ replace: Policy in Analyze failures:
- Missing signal vs overwhelming signal
- Parameter interactions
       â€¢ append: Heuristics in (new)
     ğŸ’¾ Persisted to "training-outer/prompts/inner/inner_v002.md"
     âœ“ Created new promptgram: inner_v002

  ğŸ“ˆ Results:
     NDCG: 0.8236 â†’ 0.8268 (Î”+0.0032)
     Failures: 10 â†’ 8
     Duration: 199.3s
     Stability: 0 collapses, 0.0000 variance
     Meta-levers: struct=0.85 temp=0.00 explore=0.50 depth=0.10 hub=0.50 focus=0.30
     Strategy capsules:
       â€¢ Reduce global PageRank bias, flatten depth penalty, amplify 
       â€¢ Dampen PageRank sinks via lower alpha, strengthen seed-local
       â€¢ Amplify seed-local expansion with slower decay, dampen globa

  ğŸ’¾ Checkpoint saved

[46m[1m OUTER STEP 2/5 [0m[49m
  ğŸ“‹ Selected promptgram: inner_v001 (mode: best)
     ğŸ“¦ Starting from best params: training-outer/runs/l2_diagnostic_run/inner_runs/step_001/results.trained.json
     [2KE 1/5 NDCG[â–                   ]0.824 Fail[â–                   ]5
     [2KE 2/5 NDCG[â–â–ˆ                  ]0.827 Fail[â–â–ˆ                  ]10
     [2KE 3/5 NDCG[â–â–‡â–ˆ                 ]0.827 Fail[â–â–ˆâ–                 ]5 âš¡CONVERGED
     [2KE 4/5 NDCG[â–â–‡â–ˆâ–„                ]0.825 Fail[â–â–ˆâ–â–„                ]7 âš¡CONVERGED
     [42m[1m TRAINING COMPLETE [0m[49m
     [1mNDCG@10[0m: 0.8241 â†‘ 0.8253  ([32m+0.0012[39m)
     Final NDCG@10: 0.8274
     Episodes: 4
  ğŸ§  Invoking L2 reasoning (gemini)...
  ğŸ“ L2 proposal: mode=exploit, confidence=0.85
     2 edits proposed
       â€¢ append: Heuristics in (new)
       â€¢ append: Policy in (new)
     ğŸ’¾ Persisted to "training-outer/prompts/inner/inner_v003.md"
     âœ“ Created new promptgram: inner_v003

  ğŸ“ˆ Results:
     NDCG: 0.8241 â†’ 0.8253 (Î”+0.0012)
     Failures: 10 â†’ 7
     Duration: 113.8s
     Stability: 0 collapses, 0.0000 variance
     Meta-levers: struct=0.85 temp=0.00 explore=0.50 depth=0.10 hub=0.50 focus=0.30
     Strategy capsules:
       â€¢ Flatten depth penalties; distractors dominating at root
       â€¢ Localize PageRank, amplify direct symbol links, dampen tempo
       â€¢ Aggressively localize PageRank, suppress temporal noise, rew

  ğŸ’¾ Checkpoint saved

[46m[1m OUTER STEP 3/5 [0m[49m
  ğŸ“‹ Selected promptgram: inner_v001 (mode: best)
     ğŸ“¦ Starting from best params: training-outer/runs/l2_diagnostic_run/inner_runs/step_001/results.trained.json
     [2KE 1/5 NDCG[â–                   ]0.827 Fail[â–                   ]7
     [2KE 2/5 NDCG[â–â–…                  ]0.827 Fail[â–â–ˆ                  ]10
     [2KE 3/5 NDCG[â–â–â–ˆ                 ]0.845 Fail[â–…â–ˆâ–                 ]3 ~stabilizing
     [2KE 4/5 NDCG[â–â–â–†â–ˆ                ]0.854 Fail[â–…â–ˆâ–â–‚                ]4 ~stabilizing
     â€¢ Failure 4 (NDCG=0) indicates import graph between doc/man.rs and defs.rs isn't being traversed - check if focus expansion follows use/mod statements
     [2KE 5/5 NDCG[â–â–â–†â–ˆâ–ˆ               ]0.852 Fail[â–…â–ˆâ–â–‚â–ƒ               ]5 âš¡CONVERGED
     [42m[1m TRAINING COMPLETE [0m[49m
     [1mNDCG@10[0m: 0.8269 â†‘ 0.8519  ([32m+0.0250[39m)
     Final NDCG@10: 0.8481
     Episodes: 5
  ğŸ† New best! NDCG=0.8519 - params saved for warm start
  ğŸ§  Invoking L2 reasoning (gemini)...
  ğŸ“ L2 proposal: mode=explore, confidence=0.85
     2 edits proposed
       â€¢ replace: Policy in Analyze trajectory state:
- Improving: continue direction
- Degrading: revert or reverse
- Plateaued: orthogonal move
       â€¢ append: Heuristics in Depth penalties break monorepos
     ğŸ’¾ Persisted to "training-outer/prompts/inner/inner_v004.md"
     âœ“ Created new promptgram: inner_v004

  ğŸ“ˆ Results:
     NDCG: 0.8269 â†’ 0.8519 (Î”+0.0250)
     Failures: 10 â†’ 5
     Duration: 161.9s
     Stability: 0 collapses, 0.0001 variance
     Meta-levers: struct=0.59 temp=0.00 explore=0.50 depth=0.05 hub=0.50 focus=0.30
     Strategy capsules:
       â€¢ Relax depth penalties for monorepo crates; amplify structura
       â€¢ Invert depth gradient: penalize shallow, reward deep; triple
       â€¢ Flatten depth gradient toward depth-neutral; boost structura

  ğŸ’¾ Checkpoint saved

[46m[1m OUTER STEP 4/5 [0m[49m
  ğŸ“‹ Selected promptgram: inner_v001 (mode: best)
     ğŸ“¦ Starting from best params: training-outer/runs/l2_diagnostic_run/inner_runs/step_003/results.trained.json
     [2KE 1/5 NDCG[â–                   ]0.845 Fail[â–                   ]4
     [2KE 2/5 NDCG[â–â–ˆ                  ]0.849 Fail[â–ˆâ–                  ]3
     [2KE 3/5 NDCG[â–â–ˆâ–†                 ]0.848 Fail[â–ˆâ–â–ˆ                 ]4 âš¡CONVERGED
     [2KE 4/5 NDCG[â–â–…â–ƒâ–ˆ                ]0.853 Fail[â–ˆâ–…â–ˆâ–                ]2 âš¡CONVERGED
     [2KE 5/5 NDCG[â–â–…â–ƒâ–ˆâ–               ]0.845 Fail[â–ˆâ–…â–ˆâ–â–ˆ               ]4 âš¡CONVERGED
     â€¢ NDCG=0.000 on flags/defs.rsâ†’flags/doc/man.rs reveals focus propagation doesn't traverse directory structure - may need explicit path-prefix affinity signal
     [42m[1m TRAINING COMPLETE [0m[49m
     [1mNDCG@10[0m: 0.8449 â†‘ 0.8450  ([32m+0.0001[39m)
     Final NDCG@10: 0.8475
     Episodes: 5
  ğŸ§  Invoking L2 reasoning (gemini)...
  ğŸ“ L2 proposal: mode=exploit, confidence=0.90
     2 edits proposed
       â€¢ replace: Heuristics in Depth penalties break monorepos
       â€¢ append: Policy in (new)
     ğŸ’¾ Persisted to "training-outer/prompts/inner/inner_v005.md"
     âœ“ Created new promptgram: inner_v005

  ğŸ“ˆ Results:
     NDCG: 0.8449 â†’ 0.8450 (Î”+0.0001)
     Failures: 10 â†’ 4
     Duration: 182.7s
     Stability: 0 collapses, 0.0000 variance
     Meta-levers: struct=0.59 temp=0.00 explore=0.50 depth=0.05 hub=0.50 focus=0.30
     Strategy capsules:
       â€¢ Reduce hub bias, increase structural signal, flatten depth c
       â€¢ Rescue deep crates paths, localize PageRank, amplify seed ne
       â€¢ Rehabilitate deep files by reducing depth penalty, hyperloca

  ğŸ’¾ Checkpoint saved

[46m[1m OUTER STEP 5/5 [0m[49m
  ğŸ“‹ Selected promptgram: inner_v001 (mode: best)
     ğŸ“¦ Starting from best params: training-outer/runs/l2_diagnostic_run/inner_runs/step_003/results.trained.json
     [2KE 1/5 NDCG[â–                   ]0.852 Fail[â–                   ]7
     [2KE 2/5 NDCG[â–ˆâ–                  ]0.846 Fail[â–ˆâ–                  ]2
     [2KE 3/5 NDCG[â–…â–â–ˆ                 ]0.856 Fail[â–ˆâ–‚â–                 ]1 âš¡CONVERGED
     [2KE 4/5 NDCG[â–…â–â–ˆâ–‡                ]0.854 Fail[â–ˆâ–‚â–â–‚                ]2 âš¡CONVERGED
     [2KE 5/5 NDCG[â–„â–â–†â–…â–ˆ               ]0.860 Fail[â–ˆâ–‚â–â–‚â–‚               ]2 âš¡CONVERGED
     [42m[1m TRAINING COMPLETE [0m[49m
     [1mNDCG@10[0m: 0.8521 â†‘ 0.8597  ([32m+0.0075[39m)
     Final NDCG@10: 0.8599
     Episodes: 5
  ğŸ† New best! NDCG=0.8597 - params saved for warm start
  ğŸ§  Invoking L2 reasoning (gemini)...
  ğŸ“ L2 proposal: mode=exploit, confidence=0.85
     3 edits proposed
       â€¢ replace: Heuristics in Depth penalties break monorepos
       â€¢ append: Heuristics in (new)
       â€¢ replace: Policy in Analyze failures:
- Missing signal vs overwhelming signal
     ğŸ’¾ Persisted to "training-outer/prompts/inner/inner_v006.md"
     âœ“ Created new promptgram: inner_v006

  ğŸ“ˆ Results:
     NDCG: 0.8521 â†’ 0.8597 (Î”+0.0075)
     Failures: 10 â†’ 2
     Duration: 179.5s
     Stability: 0 collapses, 0.0000 variance
     Meta-levers: struct=0.42 temp=0.00 explore=0.50 depth=0.03 hub=0.50 focus=0.31
     Strategy capsules:
       â€¢ Localize PageRank + relax depth penalties for monorepo crate
       â€¢ Invert depth bias to filter root distractors + strengthen te
       â€¢ Rehabilitate deep monorepo files via depth_weight_deep incre

  ğŸ’¾ Checkpoint saved


â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[42m[1m OUTER LOOP COMPLETE [0m[49m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    L2 RUN STATISTICAL SUMMARY                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â•â•â• NDCG TRAJECTORY â•â•â•
  Episodes:     5
  First:        0.8268
  Last:         0.8597
  Best:         0.8597 (step 5)
  Worst:        0.8253
  Mean:         0.8417
  Std Dev:      0.0136
  Total Î”:      +0.0328 (+4.0%)

â•â•â• LEARNING DIAGNOSIS â•â•â•
  Warm-started:  4 / 5 (80%)
  âœ“  IMPROVED by 0.0328 (2.4Ïƒ)

â•â•â• PARAMETER EVOLUTION â•â•â•
  Most changed params (cumulative absolute Î”):
    boost_temporal_coupling: Î”2.07 (2 changes)
    boost_focus_expansion: Î”1.50 (1 changes)
    focus_max_hops: Î”0.60 (1 changes)
    depth_weight_root: Î”0.51 (2 changes)
    pagerank_alpha: Î”0.43 (2 changes)

â•â•â• STABILITY â•â•â•
  Collapses:    0 total
  Oscillations: 9 total
  Converged:    2 / 5 runs

â•â•â• BEST CONFIGURATION â•â•â•
  NDCG:   0.8597
  Step:   5
  Path:   training-outer/runs/l2_diagnostic_run/inner_runs/step_005/results.trained.json

â•â•â• STRUCTURAL INSIGHTS â•â•â•
  â€¢ Test files as seeds need stronger local expansion to reach their actual dependencies
  â€¢ Expected targets have direct structural links to seeds but lose to depth + hub effects
  â€¢ Monorepo crate structure (crates/X/src/...) needs special depth handling - files within same crate are semantically close despite path depth
  â€¢ Directory co-location within same crate subtree should boost affinity beyond raw graph edges
  â€¢ crates/*/src/* pattern files are 'semantic hubs' but 'structural periphery' - need signal inversion

Total strategy capsules recorded: 24

Outputs saved to: "training-outer/runs/l2_diagnostic_run"
